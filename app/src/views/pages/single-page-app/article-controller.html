<header class="docs-header">
  <h1 class="docs-heading">Controller</h1>
  <section class="docs-intro">
    <i>class Controller extends Page</i>
  </section>
</header>

<section class="docs-section" id="item-3-1">
  <h2 class="section-heading">Properties</h2>
  No properties. All properties are inherited from the Page class.
</section>

<section class="docs-section" id="item-3-2">
  <h2 class="section-heading">Hook Methods</h2>
  <p>
    Use this methods in the controller as lifecycle hooks.
    <br><b style="color:orange">PRERENDER &rarr; RENDER &rarr; POSTRENDER &rarr; INIT &rarr; DESTROY</b>
    <br>
    <br>The lifecycle hooks are related to render HTML elements with <b>data-rg-</b> attribute. The regoch SPA framework will render all elements with
    data-rg- attributes. Here is the example of one data-rg- element: <small>&lt;span data-rg-print="product.name"&gt;&lt;/span&gt;</small>
    which will set SPAN innerHTML with product.name (controller property value).
  </p>
	<ul class="methods">
    <li>
      <i>async</i> <b>prerender <i>(trx :object): Promise&lt;void&gt;</i></b>
      <p class="desc">It's a controller lifecycle hook which executes the controller code before the "data-rg-..." elements are rendered.
      <br><b>trx</b> - regoch router transitional variable (carrier). See <a href="/router#item-2-2" data-rg-href>here</a>.</p>
    </li>
    <li>
      <i>async</i> <strong>render <i>(renderDelay :number, trx :object): Promise&lt;void&gt;</i></strong>
      <p class="desc">Render all elements with the "data-rg-..." attribute. Don't use it in the controller.
      <br><b>renderDelay</b> - delay in <b>miliseconds</b> between stages in the controller render hook.
      The developer can define it in the <a href="/single-page-app#item-7-3" data-rg-href>route option</a>.
      <br><b>trx</b> - regoch router transitional variable (carrier)</p>
    </li>
    <li>
      <i>async</i> <b>postrender <i>(trx :object): Promise&lt;void&gt;</i></b>
      <p class="desc">It's a controller lifecycle hook which executes the controller code after the "data-rg-..." elements are rendered.
      <br><b>trx</b> - regoch router transitional variable (carrier)</p>
    </li>
    <li><i>async</i> <b>init <i>(trx :object): Promise&lt;void&gt;</i></b>
      <p class="desc">Executes the controller code after the postrender.
      It should be used to call internal controller methods. Thus internal controller logic will be nicely separated from the data-rg render process.
      <br><b>trx</b> - regoch router transitional variable (carrier)</p>
    </li>
    <li><i>async</i> <b>destroy <i>(pevent :Event): Promise&lt;void&gt;</i></b>
      <p class="desc">Executes the controller code on destroying the controller, i.e. on navig.onUrlChange event.
      <br>This method will terminate all data-rg listeners activated by current controller (for example data-rg-click which listens for clicks on the element). This is very important to save browser's (app) memory space and to prevent memory leaks.
      <br><b>pevent</b> - the 'popstate' (back/forward buttons) or 'pushstate' (data-rg-href element click) event</p>
    </li>

  </ul>
</section>


<section class="docs-section" id="item-3-3">
  <h2 class="section-heading">Example</h2>
  <pre><code class="language-javascript">
const { Controller, syslib } = require('regoch-spa');

module.exports = class HomeCtrl extends Controller {

  constructor(app) {
    super();
    this.util = syslib.util;
  }

  async prerender(trx) {
    console.log('HOME prerender', trx);

    this.setTitle('The Regoch Project');
    this.setDescription('The Regoch Project is bundle of developer tools and frameworks for realtime, web and mobile applications: regoch websocket server and client, single page app, database.');
    this.setKeywords('regoch, websocket, realtime, mobile applications, single page app, database');
    this.setLang('en');

    this.loadCSS([
      'https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-coy.min.css'
    ]);

    await this.loadView('#primary', 'pages/home/primary.html', 'sibling');
    this.loadViews([
      ['#top', 'pages/shared/top.html'],
      ['#main', 'pages/home/main.html'],
      ['#bottom', 'pages/home/bottom.html']
    ], true);
  }


  async postrender(trx) {
    console.log('HOME postrender', trx, this.rgListeners);

    this.lazyJS([
      'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js'
    ]);
  }


  async init(trx) {
    // MAIN CONTROLLER LOGIC GOES HERE
    this.myTest();
  }


  async destroy(elem, event) {
    // CODE TO EXECUTE WHEN URL IS CHANGED i.e. WHEN CONTROLLER IS DESTROYED
    this.unlazyJS();
  }




  myTest() {
    console.log('This is INIT test.');
  }


};
  </code></pre>
</section>



