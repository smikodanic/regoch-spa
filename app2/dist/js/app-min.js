!function(){return function e(t,o,r){function s(i,a){if(!o[i]){if(!t[i]){var l="function"==typeof require&&require;if(!a&&l)return l(i,!0);if(n)return n(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var h=o[i]={exports:{}};t[i][0].call(h.exports,function(e){return s(t[i][1][e]||e)},h,h.exports,e,t,o,r)}return o[i].exports}for(var n="function"==typeof require&&require,i=0;i<r.length;i++)s(r[i]);return s}}()({1:[function(e,t,o){t.exports={"inc/footer.html":'<div id="footer"><p>This is the first footer.</p><span data-rg-view="footer2">--- load footer2 ---</span></div>',"inc/footer2.html":'<b>Bold footer2.</b> My tekst. <span data-rg-view="footer3">--- load footer3 ---</span>',"inc/footer3.html":'<br><i>This is italic footer3.</i> <span style="color:red">The red tekst.</span>',"inc/header.html":"<h2>HEADER <small>little boy</small> <b>boldy</b></h2><p>Header txt.</p>"}},{}],2:[function(e,t,o){const r=e("../../sys/App"),s=e("./conf/routesCnf"),n=e("./conf/appCnf"),i=e("./conf/httpClientCnf"),a=e("./controllers"),l=new r;l.conf("app",n).conf("httpClient",i).const("myNum",10).const("myStr","some thing").const("myObj",{a:22}).freeze(),l.system(i),l.controller(a).routes(s).run()},{"../../sys/App":13,"./conf/appCnf":3,"./conf/httpClientCnf":4,"./conf/routesCnf":5,"./controllers":11}],3:[function(e,t,o){t.exports={baseURL:"http://localhost:4400"}},{}],4:[function(e,t,o){t.exports={encodeURI:!0,timeout:1e4,retry:5,retryDelay:1300,maxRedirects:0,headers:{authorization:"",accept:"*/*","content-type":"text/html; charset=UTF-8"}}},{}],5:[function(e,t,o){t.exports=[["when","/","IndexCtrl"],["when","/page1","Page1Ctrl"],["when","/page/:pageNum","Page2Ctrl"],["when","/form","FormCtrl"],["notFound","NotfoundCtrl"]]},{}],6:[function(e,t,o){const{Controller:r,Form:s,Load:n,Util:i}=e("../../../sys");t.exports=class extends r{constructor(e){super(),this.load=e.sys.load,this.util=e.sys.util,this.userForm=new e.sys.Form("userF")}async prerender(e){await this.load.view("home1","form.html")}async init(e,t){console.log("FORM init",e,t)}async setFullName(){this.userForm.setControl("fullName","John"),await this.util.sleep(1300),this.userForm.setControl("fullName","Johnny"),await this.util.sleep(800);const e=this.userForm.getControl("fullName");console.log("fullName::",e),await this.util.sleep(800),this.userForm.delControl("fullName")}async getFullName(){const e=this.userForm.getControl("fullName");console.log("fullName::",e)}async setAge(){this.userForm.setControl("age",23)}async getAge(){const e=this.userForm.getControl("age");console.log("age::",typeof e,e)}async setCountry(){this.userForm.setControl("country","Croatia"),await this.util.sleep(1300),this.userForm.setControl("country","UK"),await this.util.sleep(1300),this.userForm.delControl("country")}async getCountry(){const e=this.userForm.getControl("country");console.log("country::",e)}async setFamily(){this.userForm.setControl("family",["Betty","Lara"])}async getFamily(){const e=this.userForm.getControl("family");console.log("family::",e)}async emptyFamily(){this.userForm.delControl("family")}async setJobs(){this.userForm.setControl("jobs",["IT","Marketing"])}async getJobs(){const e=this.userForm.getControl("jobs");console.log("selected jobs::",e)}async emptyJobs(){this.userForm.delControl("jobs")}async setPet(){this.userForm.setControl("pet","cat")}async getPet(){const e=this.userForm.getControl("pet");console.log("selected pet::",e)}async emptyPet(){this.userForm.delControl("pet")}async setAll(){this.userForm.setControls({fullName:"John Doe",age:48,country:"Kenya"})}}},{"../../../sys":22}],7:[function(e,t,o){const{Controller:r}=e("../../../sys");t.exports=class extends r{constructor(e){super(),console.log("HOME constructor"),this.load=e.sys.load,this.util=e.sys.util,this.httpClient=e.sys.httpClient,this.controllers=e.controllers,this.cookie=new e.sys.Cookie({domain:"localhost",path:"/",expires:5,secure:!1,httpOnly:!1,sameSite:"strict"},!0),this.ifX=!1,this.cookieForm=new e.sys.Form("cookieF")}async prerender(e){console.log("HOME prerender",e),await this.load.view("header","inc/header.html","h2 > small","sibling"),await this.load.view("footer","inc/footer.html"),await this.load.view("footer2","inc/footer2.html","","outer"),await this.load.view("footer3","inc/footer3.html","","outer"),await this.load.view("home1","home1.html"),await this.load.view("home2","home2.html")}async postrender(e){console.log("HOME postrender",e,this.dataRgs)}async init(e){console.log("HOME init",e,this.dataRgs),this.product={name:{x:"Initial val"},colors:["red","green"]},this.rgPrint("product.name.x"),await this.util.sleep(1300),this.product.name.x="Modified val",this.limit=3,this.skip=2,this.companies=[{name:"Cloud Ltd",size:3},{name:"Roto Ltd",size:5},{name:"Zen Ltd",size:8},{name:"Den Ltd",size:9},{name:"Len Ltd",size:10},{name:"Pen Ltd",size:81},{name:"Gen Ltd",size:82},{name:"Ren Ltd",size:83}]}destroy(e,t,o){console.log("HOME destroy",e,t,o)}async toggleIF(){this.ifX=!this.ifX,console.log("toggleIF::",this.ifX),this.rgIf("ifX")}runFOR(){this.companies=[{name:"Cloud2 Ltd",size:3},{name:"Roto2 Ltd",size:5},{name:"Zen2 Ltd",size:8},{name:"Den2 Ltd",size:81},{name:"Len2 Ltd",size:82},{name:"Pen2 Ltd",size:83},{name:"Gen2 Ltd",size:84},{name:"Ren2 Ltd",size:855}],this.rgFor("companies"),this.rgPrint("companies")}runREPEAT(e){this.colors=["red","green","blue","navy","cyan"],this.rgRepeat(e,"colorID"),this.rgSet("colors"),this.rgPrint("colors")}runCLASS(){this.myKlases=["my-bold","my-italic"],this.rgClass("myKlases")}runSTYLE(e,t){this.myStajl={fontSize:e,color:t},this.rgStyle("myStajl")}runSWITCH(){this.myColorArr=["green2","blue2"],this.rgSwitch("myColor"),this.rgSwitch("myColorArr @@ multiple")}runELEM(){this.toggle=!this.toggle,this.toggle?this.rgelems.myElem.style.color="blue":this.rgelems.myElem.style.color="silver"}runEVT(e,t,o){e.style.color=o}runCHANGE(){switch(console.log(this.mySelect),this.ifs={one:!1,two:!1,three:!1},this.ifOne=!1,this.ifTwo=!1,this.ifThree=!1,this.mySelect){case"one":this.ifs.one=!0;break;case"two":this.ifs.two=!0;break;case"three":this.ifs.three=!0}this.rgSwitch("mySelect")}runCOOKIE(){const e=this.cookieForm.getControl("cookieVal1"),t=this.cookieForm.getControl("cookieVal2"),o=this.cookieForm.getControl("cookieMethod");switch(console.log(o,":",e,t),o){case"put":this.cookie.put(e,t);break;case"putObject":this.cookie.putObject("someObj",{x:22,y:"str"});break;case"getAll":console.log(this.cookie.getAll());break;case"get":console.log(this.cookie.get(e));break;case"getObject":console.log(this.cookie.getObject("someObj"));break;case"remove":this.cookie.remove(e);break;case"removeAll":this.cookie.removeAll();break;case"empty":this.cookie.empty(e);break;case"exists":console.log(this.cookie.exists(e))}}clickFja(e,t,...o){if(console.log("This is a click. Params::",e,t,o),this.callAPI(),o[2]){const e=o[2];e.style.color="red",e.style.backgroundColor="#71F5D0"}}async callAPI(){const e=await this.httpClient.askOnce("api.dex8.com");console.log(e)}historyData(){console.log("window.history::",window.history)}}},{"../../../sys":22}],8:[function(e,t,o){const{Controller:r}=e("../../../sys");t.exports=class extends r{init(e){console.error(`404 not found: ${e.uri}`)}}},{"../../../sys":22}],9:[function(e,t,o){const{Controller:r,Load:s}=e("../../../sys");t.exports=class extends r{constructor(e){super(),console.log("PAGE1 constructor"),this.load=e.sys.load}async prerender(e){console.log("PAGE1 prerender",e),$("title").text("PAGE 1"),await this.load.view("header","inc/header.html","h2 > small","append"),await this.load.view("footer","inc/footer3.html"),await this.load.view("home1","page1.html","h1"),await this.load.view("home2","")}init(e,t){console.log("PAGE1 init",e,t)}destroy(e,t,o){console.log("PAGE1 destroy",e,t,o)}}},{"../../../sys":22}],10:[function(e,t,o){const{Controller:r,Load:s}=e("../../../sys");t.exports=class extends r{constructor(e){super(),this.load=e.sys.load}init(e,t){console.log("PAGE2 init",e,t),$("title").text("PAGE 2")}}},{"../../../sys":22}],11:[function(e,t,o){const r=e("./IndexCtrl"),s=e("./Page1Ctrl"),n=e("./Page2Ctrl"),i=e("./FormCtrl"),a=e("./NotfoundCtrl");t.exports=[r,s,n,i,a]},{"./FormCtrl":6,"./IndexCtrl":7,"./NotfoundCtrl":8,"./Page1Ctrl":9,"./Page2Ctrl":10}],12:[function(e,t,o){class r{constructor(e){this.routerOpts=e||{},this.trx,this.routeDefs=[]}set trx(e){if(!e.uri)throw new Error('The "uri" property is required.');Object.defineProperty(e,"uri",{value:e.uri,writable:!1}),Object.defineProperty(e,"body",{value:e.body,writable:!1}),e.uriParsed=this._uriParser(e.uri),this._trx=e}get trx(){return this._trx}def(e,...t){return this.routeDefs.push({route:e,routeParsed:this._routeParser(e),funcs:t}),this}redirect(e,t){const o=this.routeDefs.find(e=>e.route===t),r=o?o.funcs:[];return this.def(e,...r),this}notfound(...e){return this.def("<notfound>",...e),this}do(...e){return this.def("<do>",...e),this}async exe(){const e=this.trx.uriParsed,t=this.routeDefs.find(t=>{const o=t.routeParsed;return this._routeRegexMatchNoParams(o,e)||this._routeWithParamsMatch(o,e)}),o=this.routeDefs.find(e=>"<notfound>"===e.route),r=this.routeDefs.find(e=>"<do>"===e.route);if(t){this.trx.routeParsed=t.routeParsed,this.trx.query=e.queryObject,this.trx.params=this.trx.routeParsed?this._getParams(t.routeParsed.full,e.path):{};for(const e of t.funcs)await e(this.trx)}else if(o)for(const e of o.funcs)await e(this.trx);if(r&&r.funcs&&r.funcs.length)for(const e of r.funcs)await e(this.trx);return this.trx}_routeRegexMatchNoParams(e,t){const o=new RegExp(`^${e.full}$`,"i").test(t.path),r=e.segments===t.segments,s=o&&r;return this.routerOpts.debug&&console.log(`\n_routeRegexMatchNoParams:: (route) ${e.full} - (uri) ${t.path} -> ${s}`),s}_routeWithParamsMatch(e,t){const o=new RegExp(`^${e.base}/`,"i").test(t.path),r=e.segments===t.segments,s=/\/\:/.test(e.full),n=o&&r&&s;return this.routerOpts.debug&&console.log(`_routeWithParamsMatch:: (route) ${e.full} - (uri) ${t.path} -> ${n}`),n}_removeSlashes(e){return e.trim().replace(/^\/+/,"").replace(/\/+$/,"")}_typeConvertor(e){return e&&!isNaN(e)&&-1===e.indexOf(".")?e=parseInt(e,10):e&&!isNaN(e)&&-1!==e.indexOf(".")?e=parseFloat(e):"true"===e||"false"===e?e=JSON.parse(e):function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(e)&&(e=JSON.parse(e)),e}_toQueryObject(e){const t=e.split("&"),o={};let r,s,n;return t.forEach(e=>{r=e.split("="),s=r[0],n=r[1],n=this._typeConvertor(n),o[s]=n}),o}_uriParser(e){const t=e.split("?"),o=this._removeSlashes(t[0]),r=o.split("/").length,s=t[1];return{path:o,segments:r,queryString:s,queryObject:s?this._toQueryObject(s):{}}}_routeParser(e){const t=this._removeSlashes(e),o=t.split("/").length,r=t.replace(/\/\:.+/,"");return{full:t,segments:o,base:r}}_getParams(e,t){const o=e.split("/"),r=t.split("/"),s={};return o.forEach((e,t)=>{if(/\:/.test(e)){const o=e.replace(/^\:/,"");let n=r[t];n=this._typeConvertor(n),s[o]=n}}),s}}void 0!==t&&(t.exports=r),"undefined"!=typeof window&&(window.regochRouter=r)},{}],13:[function(e,t,o){const r=e("./eventEmitter"),s=e("./Form"),n=e("./HTTPClient"),i=e("./Load"),a=e("./Parse"),l=e("./router"),c=e("./util"),h=e("./Cookie");t.exports=class{constructor(){this.CONF={},this.CONST={},this.sys={},this.controllers={}}conf(e,t){if("app"===e){const e=["baseURL"],o=Object.keys(t)||[];for(const t of e)if(-1===o.indexOf(t))throw new Error(`The property "${t}" is required in the app configuration.`)}return this.CONF[e]=t,this}const(e,t){return this.CONST[e]=t,this}freeze(){Object.freeze(this.CONF),Object.freeze(this.CONST)}system(e){this.sys.eventEmitter=r,this.sys.util=c,this.sys.Form=s,this.sys.HTTPClient=n,this.sys.httpClient=new n(e),this.sys.load=new i(this.CONF.app.baseURL,this.sys.httpClient),this.sys.parse=new a,this.sys.Cookie=h}controller(e){for(const t of e)this.controllers[t.name]=new t(this);return this}routes(e){for(const t of e){const e=t[0];if("when"===e){const e=t[1],o=t[2],r=this.controllers[o];l.when(e,r)}else if("notFound"===e){const e=t[1],o=this.controllers[e];l.notFound(o)}}return this}run(){l.use()}}},{"./Cookie":15,"./Form":16,"./HTTPClient":17,"./Load":18,"./Parse":19,"./eventEmitter":21,"./router":23,"./util":24}],14:[function(e,t,o){const r=e("./Parse");t.exports=class extends r{constructor(){super()}async prerender(e){}async render(e){this.parseListeners(),this.parseNonListeners()}async parseListeners(){this.rgHref(),this.rgClick(),this.rgChange(),this.rgEvt(),this.rgSet()}async parseNonListeners(){this.rgPrint(),this.rgClass(),this.rgStyle(),this.rgIf(),this.rgSwitch(),this.rgFor(),this.rgRepeat(),this.rgElem()}async postrender(e){}async init(e){}async destroy(e,t){}isHtmlLoaded(){document.addEventListener("DOMContentLoaded",()=>{console.log("HTML document is loaded."),console.log(document.readyState)})}isLoaded(){window.onload=(()=>{console.log("HTML document and CSS, JS, images and other resources are loaded."),console.log(document.readyState)})}}},{"./Parse":19}],15:[function(e,t,o){t.exports=class{constructor(e,t){this.cookieOpts=e,this.debug=t}put(e,t){if(!document)throw new Error("The document is not available.");let o=`${e}=${encodeURIComponent(t)};`;o=this._appendCookieOptions(o),document.cookie=o,this.debug&&console.log("cookie-put():cookieStr: ",o)}putObject(e,t){if(!document)throw new Error("The document is not available.");let o=`${e}=${encodeURIComponent(JSON.stringify(t))};`;o=this._appendCookieOptions(o),document.cookie=o,this.debug&&console.log("cookie-putObject(): ",o)}getAll(){if(!document)throw new Error("The document is not available.");const e=document.cookie;return this.debug&&console.log("cookie-getAll(): ",e),e}get(e){if(!document)throw new Error("The document is not available.");const t=this._toCookiesArr();let o,r;return t.forEach(t=>{(o=t.split("="))[0]===e&&(r=o[1])}),r=decodeURIComponent(r),this.debug&&(console.log("cookie-get()-cookiesArr: ",t),console.log("cookie-get()-cookieVal: ",e,"=",r)),r}getObject(e){if(!document)throw new Error("The document is not available.");const t=this.get(e);let o=null;try{if("undefined"!==t&&t){const e=decodeURIComponent(t);o=JSON.parse(e)}}catch(e){console.error("cookie-getObject(): ",e)}return this.debug&&(console.log("cookie-getObject():cookieVal: ",t),console.log("cookie-getObject():cookieObj: ",o)),o}remove(e){if(!document)throw new Error("The document is not available.");let t=new Date("1970-01-01T01:00:00");t=t.toUTCString(),document.cookie=`${e}=;expires=${t};path=/;`,this.debug&&console.log("cookie-remove(): ",e," cookie is deleted.")}removeAll(){if(!document)throw new Error("The document is not available.");let e=new Date("1970-01-01T01:00:00");e=e.toUTCString();const t=this._toCookiesArr();let o;const r=[];t.forEach(t=>{o=t.split("="),document.cookie=`${o[0]}=;expires=${e};path=/;`,r.push(document.cookie)}),this.debug&&(console.log("cookie-removeAll():before:: ",t),console.log("cookie-removeAll():after:: ",r))}empty(e){if(!document)throw new Error("The document is not available.");document.cookie=`${e}=;`,this.debug&&console.log("cookie-empty(): ",e)}exists(e){if(!document)throw new Error("The document is not available.");const t=this._toCookiesArr();let o,r=!1;return t.forEach(t=>{(o=t.split("="))[0]===e&&(r=!0)}),this.debug&&console.log("cookie-exists(): ",r),r}_appendCookieOptions(e){if(!this.cookieOpts)return e;if(this.cookieOpts.domain&&(e+=`domain=${this.cookieOpts.domain};`),this.cookieOpts.path&&(e+=`path=${this.cookieOpts.path};`),this.cookieOpts.expires){let t;if("number"==typeof this.cookieOpts.expires){const e=new Date;e.setTime(e.getTime()+24*this.cookieOpts.expires*60*60*1e3),t=e.toUTCString()}else t=this.cookieOpts.expires.toUTCString();e+=`expires=${t};`}return this.cookieOpts.secure&&(e+="secure;"),this.cookieOpts.httpOnly&&(e+="HttpOnly;"),this.cookieOpts.sameSite&&(e+=`SameSite=${this.cookieOpts.sameSite};`),e}_toCookiesArr(){return document.cookie.split(";").map(e=>e.trim())}}},{}],16:[function(e,t,o){const r=e("./debug");t.exports=class{constructor(e){this.formName=e}setControl(e,t){r("setControl","--------- setControl ------","green","#A1F8DC"),r("setControl",`${e} = ${t}`,"green");const o=document.querySelectorAll(`form[data-rg-form="${this.formName}"] [name="${e}"]`);if(!o.length)throw new Error(`Form "${this.formName}" doesn't have "${e}" control.`);for(const e of o)if("checkbox"===e.type)e.checked=!1,-1!==t.indexOf(e.value)&&(e.checked=!0);else if("select-multiple"===e.type){const o=e;for(const e of o)e.selected=!1,-1!==t.indexOf(e.value)&&(e.selected=!0)}else"radio"===e.type?(e.checked=!1,t===e.value&&(e.checked=!0)):e.value=t}getControl(e){r("getControl","--------- getControl ------","green","#A1F8DC");const t=document.querySelectorAll(`form[data-rg-form="${this.formName}"] [name="${e}"]`);if(!t.length)throw new Error(`Form "${this.formName}" doesn't have "${e}" control.`);let o;const s=[];let n=1;for(const e of t){if("checkbox"===e.type)e.checked&&(s.push(e.value),o=s),n!==t.length||o||(o=[]);else if("select-multiple"===e.type){const r=e.selectedOptions;for(const e of r)s.push(e.value),o=s;n!==t.length||o||(o=[])}else"radio"===e.type?e.checked&&(o=e.value):o="number"===e.type?e.valueAsNumber:e.value;n++}return r("getControl",`${o}`,"green"),o}delControl(e){r("delControl","--------- delControl ------","green","#A1F8DC"),r("delControl",e,"green");const t=document.querySelectorAll(`form[data-rg-form="${this.formName}"] [name="${e}"]`);if(!t.length)throw new Error(`Form "${this.formName}" doesn't have "${e}" control.`);for(const e of t)if("checkbox"===e.type)e.checked=!1;else if("select-multiple"===e.type){const t=e;for(const e of t)e.selected=!1}else"radio"===e.type?e.checked=!1:e.value=""}debugger(e,t,o,r){this.debug[e]&&console.log(`%c ${t}`,`color: ${o}; background: ${r}`)}}},{"./debug":20}],17:[function(e,t,o){t.exports=class{constructor(e){this.url,this.protocol="http:",this.hostname="",this.port=80,this.pathname="/",this.queryString="",this.opts=e||{encodeURI:!1,timeout:8e3,retry:3,retryDelay:5500,maxRedirects:3,headers:{authorization:"",accept:"*/*","content-type":"text/html; charset=UTF-8"}},this.headers=this.opts.headers,this.xhr=new XMLHttpRequest}_parseUrl(e){e=this._correctUrl(e);const t=new URL(e);return this.url=e,this.protocol=t.protocol,this.hostname=t.hostname,this.port=t.port,this.pathname=t.pathname,this.queryString=t.search,e}_correctUrl(e){if(!e)throw new Error("URL is not defined");return e=e.trim(),/^https?:\/\//.test(e)||(e="http://"+e),e=this.opts.encodeURI?encodeURI(e):(e=e.replace(/\s+/g," ")).replace(/ /g,"%20")}_formatError(e,t){const o=new Error(e);return"ENOTFOUND"===e.code?(o.status=400,o.message=`400 Bad Request [ENOTFOUND] ${t}`):(o.status=e.status||400,o.message=e.message),o.original=e,o}_getTime(){return(new Date).toISOString()}_getTimeDiff(e,t){const o=new Date(e);return(new Date(t).getTime()-o.getTime())/1e3}askOnce(e,t="GET",o){const r={requestURL:e,requestMethod:t,status:0,statusMessage:"",https:!1,req:{headers:this.headers,payload:void 0},res:{headers:void 0,content:void 0},time:{req:this._getTime(),res:void 0,duration:void 0}};try{e=this._parseUrl(e),r.requestURL=e,r.https=/^https/.test(this.protocol)}catch(e){const t={...r};return t.status=400,t.statusMessage=e.message||"Bad Request",t.time.res=this._getTime(),t.time.duration=this._getTimeDiff(t.time.req,t.time.res),t}if(this.xhr.open(t,e,!0,null,null),this.xhr.timeout=this.opts.timeout,Object.keys(this.opts.headers).forEach(e=>this.xhr.setRequestHeader(e,this.opts.headers[e])),o&&!/GET/i.test(t)){r.req.payload=o;const e=JSON.stringify(o);this.headers["content-length"]=e.length}return this.xhr.send(),new Promise((t,o)=>{this.xhr.onload=(e=>{const o=e.target.response,s={...r};s.status=this.xhr.status,s.statusMessage=this.xhr.statusText,s.res.headers=this.getResHeaders(),s.res.content=o,s.time.res=this._getTime(),s.time.duration=this._getTimeDiff(s.time.req,s.time.res),t(s)}),this.xhr.onerror=(o=>{this.kill();const s=this._formatError(o,e),n={...r};n.status=s.status,n.statusMessage=s.message,n.time.res=this._getTime(),n.time.duration=this._getTimeDiff(n.time.req,n.time.res),t(n)}),this.xhr.ontimeout=(()=>{this.kill();const o={...r};o.status=408,o.statusMessage=`Request aborted due to timeout (${this.opts.timeout} ms) ${e} `,o.time.res=this._getTime(),o.time.duration=this._getTimeDiff(o.time.req,o.time.res),t(o)})})}async ask(e,t="GET",o){let r=await this.askOnce(e,t,o);const s=[r];let n=1;for(;r&&/^3\d{2}/.test(r.status)&&n<=this.opts.maxRedirects;){const i=new URL(e,r.res.headers.location);console.log(`#${n} redirection ${r.status} from ${this.url} to ${i}`),r=await this.askOnce(i,t,o),s.push(r),n++}let i=1;for(;408===r.status&&i<=this.opts.retry;)console.log(`#${i} retry due to timeout (${this.opts.timeout}) on ${e}`),await new Promise(e=>setTimeout(e,this.opts.retryDelay)),r=await this.askOnce(e,t,o),s.push(r),i++;return s}async askJSON(e,t="GET",o){let r=o;if("string"==typeof o)try{r=JSON.parse(o)}catch(e){throw new Error("Body string is not valid JSON.")}this.setHeaders({"content-type":"application/json; charset=utf-8",accept:"application/json"});const s=await this.askOnce(e,t,r);if(s.res.content)try{s.res.content=JSON.parse(s.res.content)}catch(e){throw new Error("Response content is not valid JSON.")}return s}async askHTML(e,t){const o=await this.askOnce(e),r=document.createRange().createContextualFragment(o.res.content);let s,n="";return t?(s=r.querySelector(t),n=s.outerHTML):(s=r).childNodes.forEach(e=>{1===e.nodeType?n+=e.outerHTML:3===e.nodeType&&(n+=e.data)}),o.res.content={dom:s,str:n},o}kill(){this.xhr.abort()}setHeaders(e){this.headers=Object.assign(this.headers,e)}setHeader(e,t){const o={[e]:t};this.headers=Object.assign(this.headers,o)}delHeaders(e){e.forEach(e=>{delete this.headers[e]})}getReqHeaders(){return this.headers}getResHeaders(){const e=this.xhr.getAllResponseHeaders().split("\n"),t={};return e.forEach(e=>{const o=e.split(":"),r=o[0];if(r){const e=o[1].trim();t[r]=e}}),t}}},{}],18:[function(e,t,o){const r=e("../app/dist/views/compiled.json"),s=e("./debug");t.exports=class{constructor(e,t){this.baseURL=e,this.hc=t}async view(e,t,o,n){const i=`[data-rg-view="${e}"]`,a=document.querySelector(i);if(s("loadView",`--------- loadView ${i} -- ${t} ---------`,"#8B0892","#EDA1F1"),s().loadView&&console.log("elem::",a),!a||!t)return;let l,c;if(r[t]){l=r[t];const e=(new DOMParser).parseFromString(l,"text/html");c=o?e.querySelector(o):e,s("loadView","--from compiled JSON","#8B0892")}else{const e=new URL(`/views/${t}`,this.baseURL).toString(),r=await this.hc.askHTML(e,o),n=r.res.content;if(200!==r.status||!n)return;l=r.res.content.str,c=r.res.content.dom,s("loadView","--from server","#8B0892")}if(s().loadView&&console.log("contentStr::",l),s().loadView&&console.log("contentDOM::",c),"inner"===n)a.innerHTML=l;else if("outer"===n)a.outerHTML=l;else if("sibling"===n){const e=a.parentNode,t=a.nextSibling;t.isEqualNode(c)?t.replaceWith(c):e.insertBefore(c,t)}else if("prepend"===n){const e=a.firstChild,t=document.createTextNode("");e.isEqualNode(c)&&e.replaceWith(t),a.prepend(c)}else if("append"===n){const e=a.lastChild,t=document.createTextNode("");e.isEqualNode(c)&&e.replaceWith(t),a.append(c)}else a.innerHTML=l;return{elem:a,contentStr:l,contentDOM:c,document:document}}}},{"../app/dist/views/compiled.json":1,"./debug":20}],19:[function(e,t,o){const r=e("./eventEmitter"),s=e("./debug");t.exports=class{constructor(){this.dataRgs=[],this.separator="@@",this.temp={}}async rgKILL(){s("rgKILL","------- rgKILL -------","orange","#FFD8B6");const e=[];let t=1;for(const o of this.dataRgs)o.elem.removeEventListener(o.eventName,o.handler),s("rgKILL",`${t}. killed:: ${o.attrName} --- ${o.eventName} --- ${o.elem.innerHTML}`,"orange"),e.push(Promise.resolve(!0)),t++;await Promise.all(e),this.dataRgs=[]}rgHref(){s("rgHref","--------- rgHref ------","orange","#FFD8B6");const e=document.querySelectorAll("[data-rg-href]");if(e.length)for(const t of e){const e=async e=>{e.preventDefault(),await this.destroy(t,e),this.rgKILL();const o=t.getAttribute("href").trim(),s={href:o},n=t.getAttribute("data-rg-href").trim(),i=o;window.history.pushState(s,n,i),r.emit("pushstate",s)};t.addEventListener("click",e),this.dataRgs.push({attrName:"data-rg-href",elem:t,handler:e,eventName:"click"}),s("rgHref",`pushed:: ${this.dataRgs.length} -- data-rg-href -- ${t.localName}`,"orange")}}rgClick(){s("rgClick","--------- rgClick ------","orange","#FFD8B6");const e="data-rg-click",t=document.querySelectorAll(`[${e}]`);if(t.length)for(const o of t){const t=o.getAttribute(e).trim().match(/^(.+)\((.*)\)$/),r=t[1],n=e=>{e.preventDefault();try{const n=this._getFuncArgs(t[2],o,e);if(!this[r])throw new Error(`Method "${r}" is not defined in the "${this.constructor.name}" controller.`);this[r](...n),s("rgClick",`${r} | ${n}`,"orange")}catch(e){throw new Error(e.message)}};o.addEventListener("click",n),this.dataRgs.push({attrName:e,elem:o,handler:n,eventName:"click"}),s("rgClick",`pushed:: ${this.dataRgs.length} -- ${e} -- ${r}`,"orange")}}rgChange(){s("rgChange","--------- rgChange ------","orange","#FFD8B6");const e="data-rg-change",t=document.querySelectorAll(`[${e}]`);if(t.length)for(const o of t){const t=o.getAttribute(e).trim().match(/^(.+)\((.*)\)$/),r=t[1],n=e=>{e.preventDefault();try{const n=this._getFuncArgs(t[2],o,e);if(!this[r])throw new Error(`Method "${r}" is not defined in the "${this.constructor.name}" controller.`);this[r](...n),s("rgChange",`${r} | ${n}`,"orange")}catch(e){throw new Error(e.message)}};o.addEventListener("change",n),this.dataRgs.push({attrName:e,elem:o,handler:n,eventName:"change"}),s("rgChange",`pushed:: ${this.dataRgs.length} -- ${e} -- ${r}`,"orange")}}rgEvt(){s("rgEvt","--------- rgEvt ------","orange","#FFD8B6");const e=document.querySelectorAll("[data-rg-evt]");if(e.length)for(const t of e){const e=t.getAttribute("data-rg-evt").trim(),o=e.split("&&");for(const r of o){const o=r.split(this.separator);if(!o[0]||!o[1])throw new Error(`Attribute "data-rg-evt" has bad definition (data-rg-evt="${e}").`);const n=o[0].trim(),i=o[1].trim().match(/^(.+)\((.*)\)$/),a=i[1],l=e=>{e.preventDefault();try{const o=this._getFuncArgs(i[2],t,e);if(!this[a])throw new Error(`Method "${a}" is not defined in the "${this.constructor.name}" controller.`);this[a](...o),s("rgEvt",`${a} | ${o}`,"orange")}catch(e){throw new Error(e.message)}};t.addEventListener(n,l),this.dataRgs.push({eventName:n,attrName:"data-rg-evt",elem:t,handler:l,eventName:n}),s("rgEvt",`pushed:: ${this.dataRgs.length} -- data-rg-evt -- ${a} -- ${n}`,"orange")}}}rgSet(){s("rgSet","--------- rgSet ------","navy","#B6ECFF");const e=document.querySelectorAll("[data-rg-set]");if(e.length)for(const t of e){const e=t.getAttribute("data-rg-set").split(this.separator),o=e[1]?e[1].trim():"",r=e[0].trim(),n=r.split("."),i=e=>{let i=1,a=this;for(const e of n)i!==n.length?(a[e]={},a=a[e]):a[e]=t.value,i++;"print"===o&&this.rgPrint(r),s("rgSet",`controller property:: ${r} = ${a[r]}`,"orange")};t.addEventListener("input",i),this.dataRgs.push({attrName:"data-rg-set",elem:t,handler:i,eventName:"input"}),s("rgSet",`pushed::  data-rg-set -- ${t.localName} --- dataRgs.length: ${this.dataRgs.length}`,"navy")}}rgPrint(e){let t;s("rgPrint","--------- rgPrint ------","navy","#B6ECFF");const o="data-rg-print";t=e?`${o}^="${e}"`:o;const r=document.querySelectorAll(`[${t}]`);if(s("rgPrint",`found elements:: ${r.length}`,"navy"),r.length)for(const e of r){const t=e.getAttribute(o),r=t.split(this.separator),n=r[0].trim();let i=this._getControllerValue(n);"object"==typeof(i=i||"")&&(i=JSON.stringify(i));const a=`${o} ${t}`.replace(/\s/g,"_");this.temp[a]||(this.temp[a]=e.innerHTML);let l=r[1]||"inner";if("inner"===(l=l.trim()))e.innerHTML=i;else if("outer"===l)e.outerHTML=i;else if("sibling"===l){const t=document.createTextNode(i);e.nextSibling.remove(),e.parentNode.insertBefore(t,e.nextSibling)}else e.innerHTML="prepend"===l?i+" "+this.temp[a]:"append"===l?this.temp[a]+" "+i:"inset"===l?this.temp[a].replace("${}",i):i;s("rgPrint",`${n}:: ${i} | act::"${l}"`,"navy")}}rgClass(e){s("rgClass","--------- rgClass ------","navy","#B6ECFF");let t=document.querySelectorAll("[data-rg-class]");if(e&&(t=document.querySelectorAll(`[data-rg-class^="${e}"]`)),s("rgClass",`found elements:: ${t.length}`,"navy"),t.length)for(const e of t){const t=e.getAttribute("data-rg-class")||"",o=t.split(this.separator),r=o[0].trim(),n=this[r]||[];let i=o[1]||"";"replace"==(i=i.trim()||"add")&&e.removeAttribute("class");for(const t of n)e.classList.add(t);s("rgClass",`data-rg-class="${t}" --- ctrlProp:: ${r} | ctrlVal:: ${n} | act:: ${i}`,"navy")}}rgStyle(e){s("rgStyle","--------- rgStyle ------","navy","#B6ECFF");let t=document.querySelectorAll("[data-rg-style]");if(e&&(t=document.querySelectorAll(`[data-rg-style^="${e}"]`)),s("rgStyle",`found elements:: ${t.length}`,"navy"),t.length)for(const e of t){const t=e.getAttribute("data-rg-style")||"",o=t.split(this.separator),r=o[0].trim(),n=this[r]||{};let i=o[1]||"";"replace"==(i=i.trim()||"add")&&e.removeAttribute("style");const a=Object.keys(n);for(const t of a)e.style[t]=n[t];s("rgStyle",`data-rg-style="${t}" --- ctrlProp:: "${r}" | styleProps:: "${a}" | act:: "${i}"`,"navy")}}rgIf(e){let t;s("rgIf","--------- rgIf ------","navy","#B6ECFF"),t=e?`data-rg-if^="${e}"`:"data-rg-if",this._uncommentAll();const o=document.querySelectorAll(`[${t}]`);if(s("rgIf",`found elements:: ${o.length}`,"navy"),o.length)for(const e of o){const t=e.getAttribute("data-rg-if").split(this.separator),o=t[0].trim(),r=o.split(".");let n=this[r[0]],i=0;for(const e of r)0!==i&&n&&(n=n[e]),i++;let a=t[1]||"hide";a=a.trim();const l=e.parentNode;"remove"==a&&l.setAttribute("data-rg-ifparent",""),"hide"===a?e.style.visibility=n?"visible":"hidden":"remove"===a&&!n&&this._commentElement(e),s("rgIf",`${o} = ${n} | act::"${a}"`,"navy")}}rgSwitch(e){s("rgSwitch","--------- rgSwitch ------","navy","#B6ECFF");const t="data-rg-switch";let o=document.querySelectorAll(`[${t}]`);if(e&&(o=document.querySelectorAll(`[${t}="${e}"]`)),s("rgSwitch",`found elements:: ${o.length}`,"navy"),o.length)for(const e of o){const o=e.getAttribute(t)||"",r=o.split(this.separator),n=!!r[1]&&"multiple"===r[1].trim(),i=this[r[0].trim()]||"";let a=e.querySelectorAll("[data-rg-switch] > [data-rg-switchcase]"),l=e.querySelector("[data-rg-switch] > [data-rg-switchdefault]");const c=`${t} ${o}`.replace(/\s/g,"_");this.temp[c]?(a=this.temp[c].switchcaseElems,l=this.temp[c].switchdefaultElem):this.temp[c]={switchcaseElems:a,switchdefaultElem:l},e.innerHTML="";let h=!1;for(const t of a){let r=t.getAttribute("data-rg-switchcase");r=r.trim(),n||r!==i?n&&-1!==i.indexOf(r)?(e.append(t),h=!0):t.remove():(e.innerHTML=t.outerHTML,h=!0),s("rgSwitch",`data-rg-switch="${o}" data-rg-switchcase="${r}" --- val:: "${i}"`,"navy")}!h&&l&&(e.innerHTML=l.outerHTML)}}rgFor(e){let t;s("rgFor","--------- rgFor ------","navy","#B6ECFF"),t=e?`data-rg-for^="${e}"`:"data-rg-for";const o=document.querySelectorAll(`[${t}]`);if(s("rgFor",`found elements:: ${o.length}`,"navy"),o.length)for(const e of o){const t=e.getAttribute("data-rg-for"),o=t.split(this.separator),r=o[0].trim().split(":");let n=r[1];const i=+this[n=n?n.trim():""]||1e3;let a=r[2];const l=+this[a=a?a.trim():""]||0;let c=r[0];c=c.trim();const h=this._getControllerValue(c);if(s().rgFor&&console.log("val::",h," limit::",i," skip::",l),!h)return;const u=l+i<h.length?l+i:h.length,d=`data-rg-for ${t}`.replace(/\s/g,"_");this.temp[d]||(this.temp[d]=e.innerHTML);let g=o[1]||"outer";if("outer"===(g=g.trim())){e.style.visibility="hidden",e.innerHTML="";const o=document.querySelectorAll(`[data-rg-for-gen="${t}"]`);for(const e of o)e.remove();for(let o=l;o<u;o++){const r=u-1-o+l,s=this._parse$i(r,this.temp[d]),n=e.cloneNode();n.innerHTML=s,n.style.visibility="",n.removeAttribute("data-rg-for"),n.setAttribute("data-rg-for-gen",t),e.parentNode.insertBefore(n,e.nextSibling)}}else if("inner"===g){e.innerHTML="";for(let t=l;t<u;t++)e.innerHTML+=this._parse$i(t,this.temp[d])}s("rgFor",`act:: ${g}`,"navy")}}rgRepeat(e,t){s("rgRepeat","--------- rgRepeat ------","navy","#B6ECFF");const o="data-rg-repeat";let r=document.querySelectorAll(`[${o}]`);if(t&&(r=document.querySelectorAll(`#${t}[${o}]`)),s("rgRepeat",`found elements:: ${r.length}`,"navy"),r.length)for(const n of r){const r=n.getAttribute(o),i=+e||+r.trim(),a=`${o} ${r}`.replace(/\s/g,"_");this.temp[a]||(this.temp[a]=n.innerHTML),n.style.visibility="hidden",n.innerHTML="";const l=document.querySelectorAll(`[data-rg-repeat-gen="${r}"]`);for(const e of l)e.remove();for(let e=0;e<i;e++){const t=i-1-e,o=this._parse$i(t,this.temp[a]),s=n.cloneNode();s.innerHTML=o,s.style.visibility="",s.removeAttribute("id"),s.removeAttribute("data-rg-repeat"),s.setAttribute("data-rg-repeat-gen",r),n.parentNode.insertBefore(s,n.nextSibling)}s("rgRepeat",`max:: ${i}, id: ${t}`,"navy")}}rgElem(){s("rgElem","--------- rgElem ------","navy","#B6ECFF");const e=document.querySelectorAll("[data-rg-elem]");if(s("rgElem",`found elements:: ${e.length}`,"navy"),e.length){this.rgelems||(this.rgelems={});for(const t of e){const e=t.getAttribute("data-rg-elem")||"";this.rgelems[e]=t}}}_getControllerValue(e){const t=e.split(".");let o=this[t[0]],r=0;for(const e of t)0!==r&&o&&(o=o[e]),r++;return o}_parse$i(e,t){return t.replace(/\.\$i/g,`.${e}`).replace(/\$i\s*(\+|\-|\*|\/|\%|\^)?\s*(\d+)?/g,(t,o,r)=>{let s=e;const n=parseInt(r,10);return"+"===o?s=e+n:"-"===o?s=e-n:"*"===o?s=e*n:"/"===o?s=e/n:"%"===o?s=e%n:"^"===o&&(s=Math.pow(e,n)),s})}_getFuncArgs(e,t,o){return e.split(",").map(e=>("$element"===(e=e.trim().replace(/\'|\"/g,""))&&(e=t),"$event"===e&&(e=o),e))}_commentElement(e){const t=document.createComment(e.outerHTML);e.parentNode.insertBefore(t,e),e.remove()}_uncommentAll(){const e=document.querySelectorAll("[data-rg-ifparent]"),t=new DOMParser;for(const o of e){console.log("ifParentElem.childNodes::",o.childNodes);for(const e of o.childNodes){const r=e.nodeValue;if(8===e.nodeType&&/data-rg-if/.test(r)){const s=t.parseFromString(r,"text/html").querySelector("[data-rg-if");console.log(o,e,s),s&&(o.insertBefore(s,e),e.remove())}}}}}},{"./debug":20,"./eventEmitter":21}],20:[function(e,t,o){t.exports=((e,t,o,r)=>{const s={rgKILL:!1,rgHref:!1,rgClick:!1,rgChange:!1,rgEvt:!1,rgSet:!1,rgPrint:!1,rgClass:!1,rgStyle:!1,rgIf:!0,rgSwitch:!1,rgFor:!1,rgRepeat:!1,rgElem:!1,loadView:!1,setControl:!1,getControl:!1,delControl:!1};return s[e]&&console.log(`%c ${t}`,`color: ${o}; background: ${r}`),s})},{}],21:[function(e,t,o){t.exports=new class{emit(e,t){const o=new CustomEvent(e,{detail:t});window.dispatchEvent(o)}on(e,t){window.addEventListener(e,e=>{t(e)})}once(e,t){window.addEventListener(e,o=>{t(o),window.removeEventListener(e,()=>{})},{once:!0})}off(e){window.removeEventListener(e,e=>{})}}},{}],22:[function(e,t,o){const r=e("./App"),s=e("./Controller");t.exports={App:r,Controller:s}},{"./App":13,"./Controller":14}],23:[function(e,t,o){const r=e("regoch-router"),s=e("./eventEmitter");t.exports=new class{constructor(){this.regochRouter=new r({debug:!1})}when(e,t){if(!e)throw new Error(`Route is not defined for ${t.constructor.name} controller.`);const o=t.prerender.bind(t),r=t.render.bind(t),s=t.postrender.bind(t),n=t.init.bind(t);this.regochRouter.def(e,o,r,s,n)}notFound(e){const t=e.prerender.bind(e),o=e.render.bind(e),r=e.postrender.bind(e),s=e.init.bind(e);this.regochRouter.notfound(t,o,r,s)}testRoutes(e){this.regochRouter.trx={uri:e},this.regochRouter.exe().catch(e=>console.error("ERRrouter:: ",e))}use(){const e=window.location.pathname+window.location.search;this.testRoutes(e),s.on("pushstate",e=>{const t=window.location.pathname+window.location.search;this.testRoutes(t)})}}},{"./eventEmitter":21,"regoch-router":12}],24:[function(e,t,o){t.exports=new class{sleep(e){return new Promise(t=>setTimeout(t,e))}}},{}]},{},[2]);
//# sourceMappingURL=app-min.js.map
